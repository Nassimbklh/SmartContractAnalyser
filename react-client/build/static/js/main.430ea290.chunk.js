(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{13:function(e,t,a){e.exports=a(27)},21:function(e,t,a){},27:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),l=a(12),s=a.n(l),c=(a(21),a(2)),o=a(5);const i=Object(n.createContext)(),m=e=>{let{children:t}=e;const[a,l]=Object(n.useState)(localStorage.getItem("token"));return r.a.createElement(i.Provider,{value:{token:a,login:e=>{localStorage.setItem("token",e),l(e)},logout:()=>{localStorage.removeItem("token"),l(null)}}},t)};var u=a(29);const d=Object({NODE_ENV:"production",PUBLIC_URL:""}).REACT_APP_API_URL||"/api";console.log("REACT_APP_API_URL \u27a1\ufe0f",d);const p=u.a.create({baseURL:d,headers:{"Content-Type":"application/json",Accept:"application/json"},withCredentials:!1});p.interceptors.request.use(e=>{const t=localStorage.getItem("token");return t&&(e.headers.Authorization=`Bearer ${t}`),e},e=>Promise.reject(e));const b={login:e=>p.post("/auth/login",e),register:e=>p.post("/auth/register",e)},E={analyze:e=>p.post("/analyze",e,{headers:{"Content-Type":"multipart/form-data"},responseType:"text"}),getHistory:()=>p.get("/history"),getReport:(e,t)=>p.get(`/report/${e}/${t}`,{responseType:"blob"})},v={submitFeedback:e=>p.post("/feedback",e)};const g=e=>{if(!e)return null;try{const a=e.split(".")[1].replace(/-/g,"+").replace(/_/g,"/"),n=decodeURIComponent(atob(a).split("").map(e=>"%"+("00"+e.charCodeAt(0).toString(16)).slice(-2)).join(""));return JSON.parse(n)}catch(t){return console.error("Error parsing token:",t),null}},f=(e,t)=>{const a=window.URL.createObjectURL(e),n=document.createElement("a");n.href=a,n.download=t,n.click(),window.URL.revokeObjectURL(a)},h=e=>e.response?e.response.data&&e.response.data.error?e.response.data.error:`Erreur ${e.response.status}: ${e.response.statusText}`:e.request?"Pas de r\xe9ponse du serveur. V\xe9rifiez votre connexion.":e.message||"Une erreur inconnue s'est produite";var N=function(){const{login:e}=Object(n.useContext)(i),t=Object(c.o)(),[a,l]=Object(n.useState)({wallet:"",password:""}),[s,o]=Object(n.useState)(""),m=e=>{l({...a,[e.target.name]:e.target.value})};return r.a.createElement("div",{className:"d-flex justify-content-center align-items-center bg-light vh-100"},r.a.createElement("div",{className:"card shadow-lg p-4 w-100",style:{maxWidth:"400px"}},r.a.createElement("h2",{className:"text-center mb-4"},"Connexion"),r.a.createElement("form",{onSubmit:async n=>{n.preventDefault();try{const n=await b.login(a);e(n.data.data.access_token),t("/analyze")}catch(r){o(`\u274c ${h(r)||"Adresse ou mot de passe invalide"}`)}}},r.a.createElement("div",{className:"mb-3"},r.a.createElement("label",{className:"form-label"},"Adresse de portefeuille"),r.a.createElement("input",{className:"form-control",name:"wallet",placeholder:"0x...",value:a.wallet,onChange:m,required:!0})),r.a.createElement("div",{className:"mb-3"},r.a.createElement("label",{className:"form-label"},"Mot de passe"),r.a.createElement("input",{type:"password",className:"form-control",name:"password",placeholder:"Mot de passe",value:a.password,onChange:m,required:!0})),r.a.createElement("button",{type:"submit",className:"btn btn-primary w-100"},"\u27a1Se connecter")),s&&r.a.createElement("div",{className:"alert alert-danger mt-3 text-center"},s)))};const y=[{question:"Que fait la fonction fallback() en Solidity ?",options:[{text:"Elle ex\xe9cute automatiquement un transfert ETH",isCorrect:!1},{text:"Elle est appel\xe9e quand aucune autre fonction ne correspond",isCorrect:!0},{text:"Elle initialise le contrat",isCorrect:!1},{text:"Elle supprime le contrat",isCorrect:!1}]},{question:"Quel est le probl\xe8me principal du pattern call.value() ?",options:[{text:"Manque de lisibilit\xe9",isCorrect:!1},{text:"Ralentit la transaction",isCorrect:!1},{text:"Vuln\xe9rabilit\xe9 \xe0 la r\xe9entrance",isCorrect:!0},{text:"Pas compatible avec MetaMask",isCorrect:!1}]},{question:"Le mot-cl\xe9 view dans une fonction Solidity signifie que :",options:[{text:"Elle modifie l'\xe9tat du contrat",isCorrect:!1},{text:"Elle ne retourne rien",isCorrect:!1},{text:"Elle peut seulement lire l'\xe9tat",isCorrect:!0},{text:"Elle est priv\xe9e",isCorrect:!1}]},{question:"Que retourne msg.sender dans une fonction appel\xe9e via un proxy ?",options:[{text:"L'adresse du proxy",isCorrect:!1},{text:"L'adresse du wallet qui initie la transaction",isCorrect:!0},{text:"Toujours l'adresse 0x0",isCorrect:!1},{text:"Le compilateur choisit al\xe9atoirement",isCorrect:!1}]},{question:"Pourquoi utilise-t-on require() en Solidity ?",options:[{text:"Pour compiler un contrat",isCorrect:!1},{text:"Pour conditionner l'ex\xe9cution d'une fonction",isCorrect:!0},{text:"Pour cr\xe9er une boucle",isCorrect:!1},{text:"Pour envoyer des tokens",isCorrect:!1}]}],x=e=>e<=1?"d\xe9butant":2===e?"interm\xe9diaire bas":3===e?"interm\xe9diaire":4===e?"avanc\xe9":"expert";var C=function(){const e=Object(c.o)(),[t,a]=Object(n.useState)("credentials"),[l,s]=Object(n.useState)({wallet:"",password:""}),[o,i]=Object(n.useState)(Array(y.length).fill(null)),[m,u]=Object(n.useState)(""),[d,p]=Object(n.useState)("info"),E=e=>{s({...l,[e.target.name]:e.target.value})},v=e=>(e.preventDefault(),l.wallet.startsWith("0x")&&42===l.wallet.length?l.password.length<8?(u("\u274c Le mot de passe doit contenir au moins 8 caract\xe8res"),void p("danger")):(u(""),void a("assessment")):(u("\u274c L'adresse doit \xeatre un wallet Ethereum valide (0x...)"),void p("danger"))),g=async t=>{t.preventDefault();const n=(()=>{let e=0;return o.forEach((t,a)=>{null!==t&&y[a].options[t].isCorrect&&(e+=1)}),e})(),r=x(n);try{await b.register({...l,technical_score:n,technical_level:r}),u(`\u2705 Inscription r\xe9ussie ! Votre niveau technique : ${r} (${n}/5)`),p("success"),a("success"),setTimeout(()=>e("/login"),3e3)}catch(s){const e=h(s)||"\u274c Erreur lors de l'inscription";u(e),p("danger")}};return"credentials"===t?r.a.createElement("div",{className:"d-flex justify-content-center align-items-center bg-light vh-100"},r.a.createElement("div",{className:"card shadow-lg p-4 w-100",style:{maxWidth:"400px"}},r.a.createElement("h2",{className:"text-center mb-4"}," Inscription"),r.a.createElement("form",{onSubmit:v},r.a.createElement("div",{className:"mb-3"},r.a.createElement("label",{className:"form-label"},"Adresse de portefeuille"),r.a.createElement("input",{className:"form-control",name:"wallet",placeholder:"0x...",value:l.wallet,onChange:E,required:!0})),r.a.createElement("div",{className:"mb-3"},r.a.createElement("label",{className:"form-label"},"Mot de passe"),r.a.createElement("input",{type:"password",className:"form-control",placeholder:"Mot de passe (min. 8 caract\xe8res)",name:"password",value:l.password,onChange:E,required:!0})),r.a.createElement("button",{type:"submit",className:"btn btn-primary w-100"},"Continuer")),m&&r.a.createElement("div",{className:`alert alert-${d} mt-3 text-center`},m))):"assessment"===t?r.a.createElement("div",{className:"d-flex justify-content-center align-items-center bg-light min-vh-100 py-5"},r.a.createElement("div",{className:"card shadow-lg p-4 w-100",style:{maxWidth:"600px"}},r.a.createElement("h2",{className:"text-center mb-4"},"\xc9valuation technique"),r.a.createElement("p",{className:"text-center mb-4"},"R\xe9pondez aux 5 questions suivantes pour \xe9valuer votre niveau en smart contracts Solidity et s\xe9curit\xe9 blockchain."),r.a.createElement("form",{onSubmit:g},y.map((e,t)=>r.a.createElement("div",{key:t,className:"mb-4"},r.a.createElement("h5",null,t+1,". ",e.question),r.a.createElement("div",{className:"mt-2"},e.options.map((e,a)=>r.a.createElement("div",{key:a,className:"form-check mb-2"},r.a.createElement("input",{className:"form-check-input",type:"radio",name:`question-${t}`,id:`q${t}-option${a}`,checked:o[t]===a,onChange:()=>((e,t)=>{const a=[...o];a[e]=t,i(a)})(t,a),required:!0}),r.a.createElement("label",{className:"form-check-label",htmlFor:`q${t}-option${a}`},e.text)))))),r.a.createElement("div",{className:"d-flex justify-content-between mt-4"},r.a.createElement("button",{type:"button",className:"btn btn-secondary",onClick:()=>a("credentials")},"Retour"),r.a.createElement("button",{type:"submit",className:"btn btn-success",disabled:o.includes(null)},"Terminer l'inscription"))))):r.a.createElement("div",{className:"d-flex justify-content-center align-items-center bg-light vh-100"},r.a.createElement("div",{className:"card shadow-lg p-4 w-100",style:{maxWidth:"400px"}},r.a.createElement("h2",{className:"text-center mb-4"},"Inscription termin\xe9e"),m&&r.a.createElement("div",{className:`alert alert-${d} mt-3 text-center`},m),r.a.createElement("p",{className:"text-center"},"Redirection vers la page de connexion...")))};var w=function(){const[e,t]=Object(n.useState)(""),[a,l]=Object(n.useState)(null),[s,c]=Object(n.useState)(""),[o,i]=Object(n.useState)(null),[m,u]=Object(n.useState)(""),[d,p]=Object(n.useState)(!1),[b,g]=Object(n.useState)(null),[f,N]=Object(n.useState)(""),[y,x]=Object(n.useState)(""),[C,w]=Object(n.useState)(!1),[j,k]=Object(n.useState)(!1),[O,S]=Object(n.useState)("");return r.a.createElement("div",{className:"container mt-5"},r.a.createElement("h2",null,"Analyse de Smart Contract Solidity"),r.a.createElement("form",{onSubmit:async t=>{if(t.preventDefault(),u(""),c(""),i(null),g(null),N(""),x(""),w(!1),S(""),p(!0),a&&e.trim())return u("\u2757Choisissez soit un fichier, soit du code, pas les deux"),void p(!1);if(!a&&!e.trim())return u("\u2757Fournissez un fichier ou du code \xe0 analyser"),void p(!1);const n=new FormData;a&&n.append("file",a),e.trim()&&n.append("code",e);try{const e=(await E.analyze(n)).data;c(e);try{const e=await E.getHistory();if(e.data&&e.data.data&&e.data.data.length>0){const t=e.data.data[0];g(t.id)}}catch(r){console.error("Failed to fetch report ID from history:",r),S("Impossible de r\xe9cup\xe9rer l'ID du rapport. Le feedback pourrait ne pas fonctionner correctement.")}const t=window.URL.createObjectURL(new Blob([e],{type:"text/plain"}));i(t)}catch(m){console.error(m),u(`Erreur lors de l'analyse: ${h(m)}`)}finally{p(!1)}}},r.a.createElement("label",{className:"form-label mt-3"},"Coller le code :"),r.a.createElement("textarea",{className:"form-control",placeholder:"// SPDX-License-Identifier: MIT\npragma solidity ^0.8.0;\n\ncontract Example {\n    uint256 public value;\n    function setValue(uint256 _value) public {\n        value = _value;\n    }\n}",rows:"10",value:e,onChange:e=>{t(e.target.value),l(null)}}),r.a.createElement("div",{className:"text-center my-3"},"\u2014 ou \u2014"),r.a.createElement("label",{className:"form-label"},"Fichier .sol :"),r.a.createElement("input",{type:"file",accept:".sol",className:"form-control",onChange:e=>{l(e.target.files[0]),t("")}}),r.a.createElement("button",{type:"submit",className:"btn btn-primary mt-3",disabled:d},"Lancer l'analyse")),d&&r.a.createElement("div",{className:"d-flex justify-content-center mt-3"},r.a.createElement("div",{className:"spinner-border text-primary",role:"status"},r.a.createElement("span",{className:"visually-hidden"},"Chargement..."))),m&&r.a.createElement("div",{className:"alert alert-danger mt-3"},m),s&&r.a.createElement("div",{className:"mt-4 mb-4 flex flex-column"},r.a.createElement("h4",{className:"mb-2"},"R\xe9sultat de l\u2019analyse :"),r.a.createElement("pre",{className:"bg-light p-3 rounded border max-h-96 overflow-auto"},s),o&&r.a.createElement("div",{className:"d-flex justify-content-center mt-3"},r.a.createElement("a",{href:o,download:"rapport.txt",className:"btn btn-success"},"T\xe9l\xe9charger le rapport")),b&&!C?r.a.createElement("div",{className:"mt-4 p-4 border rounded bg-light"},r.a.createElement("h4",{className:"mb-3"},"Votre avis sur ce rapport :"),r.a.createElement("form",{onSubmit:async e=>{if(e.preventDefault(),S(""),k(!0),!f)return S("Veuillez s\xe9lectionner une option (valide ou invalide)"),void k(!1);if(!b)return S("Impossible d'envoyer le feedback: ID du rapport manquant"),void k(!1);try{await v.submitFeedback({report_id:b,status:f,comment:y}),w(!0)}catch(m){console.error(m);const t=h(m);t.includes("d\xe9j\xe0 donn\xe9 votre avis")||t.includes("already submitted")?(S("Vous avez d\xe9j\xe0 donn\xe9 votre avis sur ce rapport."),w(!0)):S(`Erreur lors de l'envoi du feedback: ${t}`)}finally{k(!1)}}},r.a.createElement("div",{className:"mb-3"},r.a.createElement("div",{className:"d-flex gap-3"},r.a.createElement("button",{type:"button",className:`btn ${"OK"===f?"btn-success":"btn-outline-success"}`,onClick:()=>N("OK")},"R\xe9sultat valide"),r.a.createElement("button",{type:"button",className:`btn ${"KO"===f?"btn-danger":"btn-outline-danger"}`,onClick:()=>N("KO")},"R\xe9sultat invalide"))),r.a.createElement("div",{className:"mb-3"},r.a.createElement("label",{htmlFor:"feedbackComment",className:"form-label"},"Laissez un commentaire (optionnel) :"),r.a.createElement("textarea",{id:"feedbackComment",className:"form-control",rows:"3",value:y,onChange:e=>x(e.target.value)})),O&&r.a.createElement("div",{className:"alert alert-danger"},O),r.a.createElement("button",{type:"submit",className:"btn btn-primary",disabled:j},j?r.a.createElement(r.a.Fragment,null,r.a.createElement("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"}),"Envoi en cours..."):"Envoyer mon avis"))):b&&C?r.a.createElement("div",{className:"mt-4 p-4 border rounded bg-light"},r.a.createElement("div",{className:"alert alert-success mb-0"},r.a.createElement("h5",{className:"alert-heading"},"Merci pour votre retour !"),r.a.createElement("p",{className:"mb-0"},"Votre avis a bien \xe9t\xe9 pris en compte."))):null))};var j=function(){const{token:e,logout:t}=Object(n.useContext)(i),a=Object(c.o)();return r.a.createElement("nav",{className:"navbar navbar-expand-lg navbar-light bg-light shadow-sm"},r.a.createElement("div",{className:"container"},r.a.createElement(o.b,{to:"/analyze",className:"navbar-brand d-flex align-items-center text-decoration-none"},r.a.createElement("span",{className:"me-2",role:"img","aria-label":"lock"},"\ud83d\udd10"),r.a.createElement("strong",{className:"text-dark"},"SmartContractAnalyser")),e?r.a.createElement("div",{className:"d-flex"},r.a.createElement(o.b,{to:"/history",className:"btn btn-outline-secondary"},"Historique"),r.a.createElement("button",{onClick:()=>{t(),a("/login")},className:"btn btn-outline-danger ms-2"},"D\xe9connexion")):r.a.createElement("div",{className:"d-flex"},r.a.createElement(o.b,{to:"/login",className:"btn btn-outline-primary me-2"},"Connexion"),r.a.createElement(o.b,{to:"/register",className:"btn btn-outline-success"},"Inscription"))))};var k=function(){const{token:e}=Object(n.useContext)(i),[t,a]=Object(n.useState)([]),[l,s]=Object(n.useState)(""),[c,o]=Object(n.useState)(!1);Object(n.useEffect)(()=>{e&&E.getHistory().then(e=>{e.data&&e.data.data?a(e.data.data):a([])}).catch(e=>{s(`Erreur lors du chargement de l'historique: ${h(e)}`)})},[e]);const m=(e,t)=>{if(c)return;o(!0),s("");const n={report_id:e,status:t};v.submitFeedback(n).then(n=>{a(a=>a.map(a=>a.id===e?{...a,feedback:{status:t,code_result:"OK"===t?1:0,comment:null}}:a))}).catch(e=>{const t=h(e);t.includes("d\xe9j\xe0 donn\xe9 votre avis")||t.includes("already submitted")?E.getHistory().then(e=>{e.data&&e.data.data&&a(e.data.data)}).catch(e=>{s(`Erreur lors du rafra\xeechissement de l'historique: ${h(e)}`)}):s(`Erreur lors de l'envoi du feedback: ${t}`)}).finally(()=>{o(!1)})};return r.a.createElement("div",{className:"container mt-5"},r.a.createElement("h2",null,"Historique des analyses"),l&&r.a.createElement("div",{className:"alert alert-danger"},l),0===t.length&&r.a.createElement("p",null,"Aucun rapport pour l\u2019instant."),r.a.createElement("ul",{className:"list-group mt-3"},t.map((t,a)=>r.a.createElement("li",{key:a,className:"list-group-item"},r.a.createElement("div",{className:"d-flex justify-content-between align-items-center mb-2"},r.a.createElement("span",null,t.date," \u2014 ",r.a.createElement("strong",null,t.filename)," \u2014 ",t.status),r.a.createElement("button",{className:"btn btn-outline-primary",onClick:()=>(t=>{const a=g(e);a&&a.wallet?E.getReport(a.wallet,t).then(e=>{f(e.data,`${t}.md`)}).catch(e=>{alert(`Erreur lors du t\xe9l\xe9chargement: ${h(e)}`)}):alert("Erreur: Impossible d'extraire les informations utilisateur du token")})(t.filename)},"T\xe9l\xe9charger")),r.a.createElement("div",{className:"mt-2"},t.feedback?r.a.createElement("div",{className:"alert alert-info"},r.a.createElement("strong",null,"OK"===t.feedback.status?"OK":"KO"),t.feedback.comment&&r.a.createElement("span",null," \u2014 ",t.feedback.comment),r.a.createElement("div",{className:"mt-1"},"Feedback d\xe9j\xe0 envoy\xe9")):r.a.createElement("div",{className:"d-flex gap-2"},r.a.createElement("button",{className:"btn btn-sm btn-success",onClick:()=>m(t.id,"OK"),disabled:c},"Correct"),r.a.createElement("button",{className:"btn btn-sm btn-danger",onClick:()=>m(t.id,"KO"),disabled:c},"Incorrect")))))))};function O(e){let{children:t}=e;const{token:a}=r.a.useContext(i);return a?t:r.a.createElement(c.a,{to:"/login"})}var S=function(){return r.a.createElement(m,null,r.a.createElement(o.a,null,r.a.createElement(j,null)," ",r.a.createElement(c.d,null,r.a.createElement(c.b,{path:"/login",element:r.a.createElement(N,null)}),r.a.createElement(c.b,{path:"/register",element:r.a.createElement(C,null)}),r.a.createElement(c.b,{path:"/analyze",element:r.a.createElement(O,null,r.a.createElement(w,null))}),r.a.createElement(c.b,{path:"/history",element:r.a.createElement(O,null,r.a.createElement(k,null))}),r.a.createElement(c.b,{path:"*",element:r.a.createElement(c.a,{to:"/login"})}))))};var q=e=>{e&&e instanceof Function&&a.e(3).then(a.bind(null,30)).then(t=>{let{getCLS:a,getFID:n,getFCP:r,getLCP:l,getTTFB:s}=t;a(e),n(e),r(e),l(e),s(e)})};a(26);s.a.createRoot(document.getElementById("root")).render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(S,null))),q()}},[[13,1,2]]]);
//# sourceMappingURL=main.430ea290.chunk.js.map